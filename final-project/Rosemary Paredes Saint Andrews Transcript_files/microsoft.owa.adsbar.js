try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.adsbar.js'] = (new Date()).getTime();
Type.registerNamespace("_ab");function AdsbarComponent(){}AdsbarComponent.$$cctor=function(){_a.t.a().a(AdsbarComponent)};AdsbarComponent.prototype={b:function(n,t,i){var r=this;n.b(IAdsbarViewModelFactory,function(){return new _ab.d(n.a(_g.a),n.a(_j.ba),n.a(_a.cc),n.a(_j.j),n.a(_g.E),n.a(_a.x).b(),n.a(OwaNonBootConfigurationManager),n.a(_a.s),n.a(_a.x))}).a()},a:function(){return null}};_ab.e=function(){_ab.e.initializeBase(this)};_ab.e.prototype={K:function(n){var t=new _dg.cT(this.L);n.eA(t,this.J,this.H)},cT:function(n,t,i){t()}};_ab.b=function(n,t,i,r,u,f,e,o,s,h){this.E=Function.createDelegate(this,this.bb);this.x=Function.createDelegate(this,this.be);this.v=Function.createDelegate(this,this.bc);this.w=Function.createDelegate(this,this.bd);this.y=Function.createDelegate(this,this.bf);_ab.b.initializeBase(this);_j.s.b(e,"primaryViewModel");this.b=i;this.i=this.b.a().el().Enabled;this.f=n;this.c=_a.cr.b(n.bD.AdMarket,n.t(),i.a().d());this.N=this.c.split("-")[0];this.M=this.c.split("-")[1];this.l=u;this.a=e;this.u=f;this.bi();this.e("AdsInitialized",null,null,null,null);this.n=s;this.F=h;this.d=r;this.h=[];this.C=t;if(this.u.b("overrideadssdkbaseurl")){this.j=f.a.overrideadssdkbaseurl;this.o=this.j+"adbar.js"}else{this.o=i.a().d().OwaAdBarScript?i.a().d().OwaAdBarScript:"https://r1.res.office365.com/adbar/5.5/adbar.js";this.j=i.a().d().OwaAdBarBaseUrl?i.a().d().OwaAdBarBaseUrl:"https://r1.res.office365.com/adbar/5.5/"}this.q=this.u.b("overrideastsdkurl")?f.a.overrideastsdkurl:i.a().d().AstScriptUrl?i.a().d().AstScriptUrl:"https://acdn.adnxs.com/ast/ast.js";var c=this;o.a(function(n){c.g=n;c.p=c.T();var t=c.t();c.e(t?"AdBarNotShown":"AdBarShown",t,null,null,null);if(c.p){c.d.b(_a.bb,c.y);c.d.b(_a.cy,c.w);c.d.b(_a.dh,c.v);c.d.b(_y.U,c.x);c.ba()}c.O()})};_ab.b.prototype={f:null,d:null,b:null,l:null,n:null,F:null,a:null,c:null,N:null,M:null,u:null,o:null,j:null,q:null,p:!1,m:!1,s:!1,C:null,g:null,k:!1,h:null,A:!1,B:null,i:!1,L:function(n){if(this.m!==n){this.m=n;this.eF("ShowAdBlockMessage","ShowUpsell")}return n},G:function(){return this.a.B()===2},P:function(){return this.a.bg()},z:null,H:function(){return!this.G()&&!this.m&&(this.i||this.b.a().hD().Enabled)},Q:function(){return this.i?_nbs.a.iq:_nbs.a.PL},S:function(){var n=this.b.a().el().UpsellUrlFormat;n||(n="https://aka.ms/l2?WT.mc_id={1}&ep={0}");return String.format(n,encodeURIComponent(this.l.bD.EncryptedUserPuid),"PROD_OL-Web_InApp_BannerAd_Premium")},R:function(){return new _j.g(this.E,_a.a.cT)},e:function(n,t,i,r,u){var f=new _a.l;var e=-1;if(this.a.d){e=this.a.d.h(this.B==="MCompose");e||(e=this.a.d.b)}f.a("pg",e);f.b("cm",this.c);f.b("r",t);f.b("am",i);f.b("p",r);f.b("ipg",u);f.a("w",window.innerWidth);f.a("h",window.innerHeight);_a.c.c(_a.a.cT,n,f.toString(),0)},bg:function(){var n=!1;var t=this.a.d;this.a.bp();if(this.a.d&&window.wLive&&window.wLive.adbar){if(!this.A){this.J();n=!0}window.wLive.adbar.resize(this.K())}if(this.a.d!==t){this.eP("AdBottom","ShowUpsell","AdsSmall");this.t();n||this.d.a(_a.bb,new _a.bb("Resize"))}},t:function(){var n=null;this.p?this.a.a()&&this.a.a().a&&_y.c.a.a()==="Mouse"?n="ModuleNotMail":this.a.d?this.h.length&&(n=this.h[0]):n="WindowTooSmall":n="AdsNotEnabled";var t=!n;t&&this.H()&&this.e(this.i?"AdsShowUpsell":"AdsShowAltUpsell",null,null,null,null);this.a.bn(t);return n},ba:function(){this.L(_y.c.a.a()==="Mouse");var n=this;this.C.a(this.o,function(){if(window.wLive&&window.wLive.adbar&&document.getElementById("owaadbar")){n.L(!1);n.a.d&&n.J();n.e("AdsLoaded",null,null,null,null)}})},K:function(){var n={};n.AdSizes=this.a.d.a;n.AdPageGroup=this.a.d.b?_ab.b.a+this.a.d.b:null;return n},V:function(){var n=this.K();n.BaseUrl=this.j;n.Market=this.c;n.ContainerID="owaadbar";n.AstUrl=this.q;n.CallbackEventName="AdCallbackOwa";var t=this;n.Visibility=function(){return t.a.n&&t.s};return n},eE:function(){this.d.c(_a.bb,this.y);this.d.c(_a.cy,this.w);this.d.c(_a.dh,this.v);this.d.c(_y.U,this.x);_a.fQ.prototype.eE.call(this)},J:function(){this.A=!0;var n=this.V();window.wLive.adbar.init(n)},bd:function(n){this.bh(n);this.t()},bc:function(n){n.a&&this.e("AdsBeingCovered",null,null,null,null);this.s=n.a},bf:function(n){var t=this;_j.m.a().c(_a.a.cT,"AdsRefresh",function(){var i=null;t.a.n?t.s?i="AdBarCovered":window.wLive&&window.wLive.adbar||(i="WLiveNotLoaded"):i="AdBarHidden";if(i)t.e("AdsNoRefresh",i,null,null,null);else{t.B=n.a;t.e("AdsRefresh",n.a,null,null,null);var r=t.a.d.h(n.a==="MCompose");window.wLive.adbar.refresh(n.a,r?_ab.b.a+r:null)}})},Z:function(){return!!this.b.a().d()&&_a.cr.a(this.b.a().d().SupportedMarkets,this.c)},bh:function(n){n.b?Array.remove(this.h,n.a):Array.contains(this.h,n.a)||Array.add(this.h,n.a)},Y:function(n){if(n&&n.ConsumerSubscriptions)for(var t=0;t<n.ConsumerSubscriptions.length;t++){var i=n.ConsumerSubscriptions[t];if(i==="GA-O365HOMEPREM-XX-SUB"){this.k=!0;this.e("AdBar365User",null,null,null,null);return!1}}return!1},X:function(){return this.b.a().iJ().Enabled&&(this.b.a().x().Enabled&&_a.cr.a(this.b.a().x().SupportedMarkets,this.c)||this.b.a().D().Enabled&&_a.cr.a(this.b.a().D().SupportedMarkets,this.c)||this.b.a().E().Enabled&&_a.cr.a(this.b.a().E().SupportedMarkets,this.c)||this.b.a().B().Enabled&&_a.cr.a(this.b.a().B().SupportedMarkets,this.c)||this.b.a().C().Enabled&&_a.cr.a(this.b.a().C().SupportedMarkets,this.c))},be:function(n){this.t();this.a.d&&this.d.a(_a.bb,new _a.bb("Resize"))},O:function(){if(this.W()){var n=new _ab.e;var i=this;n.b(function(t){var r=n.N;var i="";r.Subscriptions&&(i=r.Subscriptions.join(","));_j.e.a(_a.a.B,"fetchUserSubscriptionAction success subscription offerid are: {0}",i)});var t=this;n.d(function(n){_j.e.b(_a.a.B,"fetchUserSubscriptionAction failed for user",t.f.c().bD.UserPuid)});this.n.a(n)}},W:function(){if(!this.b.a().ff().Enabled||!this.g)return!1;if(this.g.ConsumerSubscriptions)for(var n=0;n<this.g.ConsumerSubscriptions.length;n++){var u=this.g.ConsumerSubscriptions[n];if(u==="GA-O365HOMEPREM-XX-SUB"){var r=_a.d.b(this.g.ConsumerSubscriptionExpireDates[n]);if(r.b(_a.d.a())>0)return!1}}var i=this.b.a().ff().DaysBeforeNextFetch;var t=null;this.g.ConsumerSubscriptionLastFetchDate&&(t=_a.d.b(this.g.ConsumerSubscriptionLastFetchDate));return!i||!t||t.c(i).b(_a.d.get_utcNow())<0},U:function(){var n=null;this.b.a().d().Enabled?this.Y(this.g)?n="o365User":this.l.bD.IsPremiumConsumerMailbox?n=this.k?"AdPaidUserO365":"AdPaidUser":this.Z()?this.f.bD.IsConsumerChild?n="ChildAccount":this.X()&&(n="NativeAdsOn"):n="NonSupportedMarket":n="mainFlightOff";var t=!n;t||this.e("AdsbarNotEnabled",n,null,null,null);return t},T:function(){var t=!1;var n=this.U();var e=(32768&this.f.a().v())!=32768;if(n!==e){if(n){var f;(f=this.f.a()).x(f.v()&-32769)}else{var u;(u=this.f.a()).x(u.v()|32768)}t=!0}var o=(1048576&this.f.a().v())!=1048576;if(this.k!==o){if(this.k){var i;(i=this.f.a()).x(i.v()&-1048577)}else{var r;(r=this.f.a()).x(r.v()|1048576)}t=!0}t&&_h.f.a(this.f.a().u,this.n);return n},bi:function(){var t=String.format("http://windows.microsoft.com/{0}/outlook/ad-free-outlook",this.c);if(this.b.a().cv().Enabled){var n=this.b.a().cv().UpsellUrlFormat;n||(n="https://aka.ms/l2?WT.mc_id={1}&ep={0}");t=String.format(n,encodeURIComponent(this.l.bD.EncryptedUserPuid),"PROD_OL-Web_InApp_AdBarBlock_Premium")}this.z=String.format(_nbs.a.HT,t)},bb:function(){this.e(this.i?"AdsUpsellClicked":"AdsAltUpsellClicked",null,null,null,null)}};_ab.d=function(n,t,i,r,u,f,e,o,s){this.j=n;this.g=t;this.e=i;this.d=r;this.h=u;this.i=f;this.f=e;this.b=o;this.c=s};_ab.d.prototype={j:null,d:null,e:null,h:null,b:null,c:null,i:null,g:null,f:null,a:function(n){return new _ab.b(this.j,this.g,this.e,this.d,this.h,this.i,n,this.f,this.b,this.c)}};_ab.c=function(n,t,i){this.h=Function.createDelegate(this,this.l);this.c=Function.createDelegate(this,this.k);this.d=Function.createDelegate(this,this.m);this.i=Function.createDelegate(this,this.n);this.e=Function.createDelegate(this,this.o);_ab.c.initializeBase(this,[n]);this.b=t;this.f=i};_ab.c.prototype={b:null,f:null,a:null,P:function(){_j.c.prototype.P.call(this);this.b.h(this.e);_j.k.b(this.z,"AdCallbackOwa",this.i);_j.k.b(this.z,"AdLoadedCallback",this.d);_j.k.b(this.z,"AdErrorCallback",this.d)},H:function(){_j.c.prototype.H.call(this);this.a=this.B.a("AdBlockHtmlLabel");this.a&&this.a.gc(this.c);this.g()},bH:function(){this.b&&this.b.j(this.e);this.z&&_j.k.c(this.z,"AdCallbackOwa");this.a&&this.a.kI(this.c);_j.c.prototype.bH.call(this)},k:function(n){for(var i=_j.A.e(n.z.childNodes,"a[target]"),t=0;t<i.length;t++)_j.k.b(i[t],"click",this.h)},l:function(n){var t=new _a.l;t.c("PU",this.f.a().cv().Enabled);t.b("M",_g.a.a().bD.AdMarket||_g.a.a().t().toLowerCase());_a.c.c(_a.a.cT,"ClickAdBlockFreeLink",t.toString(),0)},o:function(){var n=this.V();n&&n.bg();this.g()},m:function(n){this.j(n.i(),n)},n:function(n){this.g();var t=n.s;this.j("AdsImpressed",n)},j:function(n,t){var i=t.s;var r=this.V();r&&r.e(n,i.ContextRefreshName,i.UserMarket,i.Provider,i.PageGroup)},g:function(){var t="";var n=this.V();if(n&&n.a.B()===2){t=window.innerWidth+"px";if(n.a.d){this.z.style.width=n.a.d.g()+17+"px";this.z.style.height=n.a.d.d()+"px"}}this.X.z.style.width=t}};_ab.a=function(){};_ab.a.$$cctor=function(){_ab.a._I()};_ab.a.e=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <div class='__Microsoft_Owa_Adsbar_templates_cs_8'> <span class='__Microsoft_Owa_Adsbar_templates_cs_4 ms-fcl-nsa'> </span> <span class='__Microsoft_Owa_Adsbar_templates_cs_5 ms-fwt-r ms-font-color-black'></span> </div> </div><div> <div class='__Microsoft_Owa_Adsbar_templates_cs_2'></div> <a class='__Microsoft_Owa_Adsbar_templates_cs_9 ms-font-color-themePrimary'></a> </div>";_j.i.a().appendChild(n);return n};_ab.a.k=function(n){return n.z};_ab.a.l=function(n){return n.G()};_ab.a.m=function(n){return n.P()};_ab.a.o=function(n){return n.m};_ab.a.r=function(n){return n.S()};_ab.a.p=function(n){return n.H()};_ab.a.q=function(n){return n.R()};_ab.a.n=function(n){return n.Q()};_ab.a.h=function(n,t){n.a(t)};_ab.a.s=function(n,t){n.a(t)};_ab.a.i=function(n,t){n.b(t)};_ab.a.j=function(n,t){n.K(t)};_ab.a.f=function(n,t){n.T(t)};_ab.a.g=function(n,t){n.j(t)};_ab.a.d=function(){_ab.a.b||(_ab.a.b=new _fc.k);return _ab.a.b};_ab.a._I=function(){var t="AdsbarPanelView._tid1";new _j.d(t,function(){_ab.a.a[t]===undefined&&(_ab.a.a[t]=[[[-1,4,null,null,null,"Id",null,_ab.a.h,0,null,null,null,_fm.a.bo]],[[-1,0,["AdBlockUseAdFreeMessage"],[_ab.a.k],null,"Html",null,_ab.a.s,1,null,null,null]]]);var n=_ab.a.c.childNodes[0].cloneNode(!0);var i=new _b.p(_j.a.a(n,[0,1]),_j.b.Instance.a(_a.f));var r=new _fc.d(_j.a.a(n,[0,0]),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));return new _j.a(n,[r,i]).l({AdBlockHtmlLabel:i})},"",_ab.b,_ab.c,function(n){return new _ab.c(n,_j.b.Instance.a(_y.a),_j.b.Instance.a(_a.f))},!1,!0,!1,0,_ab.a.a);var n="AdsbarPanelView";new _j.d(n,function(){_ab.a.a[n]===undefined&&(_ab.a.a[n]=[[[-1,5,["AdBottom"],[_ab.a.l],null,"__Microsoft_Owa_Adsbar_templates_cs_6",null,null,0,null,null,null],[-1,5,["AdsSmall"],[_ab.a.m],null,"__Microsoft_Owa_Adsbar_templates_cs_7",null,null,0,null,null,null],[-1,5,["ShowAdBlockMessage"],[_ab.a.o],null,"__Microsoft_Owa_Adsbar_templates_cs_3",null,null,0,_ab.a.d(),null,null]],[[-1,0,["UpsellLink"],[_ab.a.r],null,"Href",null,_ab.a.i,1,null,null,null],[-1,0,["ShowUpsell"],[_ab.a.p],null,"IsHidden",null,_ab.a.j,1,_ab.a.d(),null,!0],[-1,0,["UpsellClickCommand"],[_ab.a.q],null,"ClickCommand",null,_ab.a.f,1,null,null,null],[-1,0,["PremiumUpsellText"],[_ab.a.n],null,"Text",null,_ab.a.g,1,null,null,null]]]);var i=_ab.a.c.childNodes[1].cloneNode(!0);var r=new _fc.e(i.children[1]);r.a("_blank");var t=new _ab.c(i.children[0],_j.b.Instance.a(_y.a),_j.b.Instance.a(_a.f));t.O("owaadbar");t.y("AdsbarPanelView._tid1");return new _j.a(i,[t,r])},"",_ab.b,_ab.c,function(n){return new _ab.c(n,_j.b.Instance.a(_y.a),_j.b.Instance.a(_a.f))},!1,!1,!1,0,_ab.a.a)};AdsbarComponent.registerClass("AdsbarComponent",null,_a.iJ,_j.cd);_ab.e.registerClass("_ab.e",_h.fl);_ab.b.registerClass("_ab.b",_a.bt,IAdsbarViewModel,_j.br,Sys.IDisposable);_ab.c.registerClass("_ab.c",_j.c);AdsbarComponent.$$cctor();_ab.b.a="WAB";_ab.a.c=_ab.a.e();_ab.a.b=null;_ab.a.a={};_ab.a.$$cctor();
window.scriptsLoaded['microsoft.owa.adsbar.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.adsbar.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
