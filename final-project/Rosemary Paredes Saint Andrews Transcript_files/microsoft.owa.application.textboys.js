try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.application.textboys.js'] = (new Date()).getTime();
function TextBoysComponents(){}TextBoysComponents.$$cctor=function(){_a.t.a().a(TextBoysComponents)};TextBoysComponents.prototype={b:function(n,t,i){var r=this;n.b(_tb.a,function(){return new _tb.a}).a()},a:function(){return[]}};Type.registerNamespace("_tb");_tb.c=function(n,t,i){_tb.c.initializeBase(this,[n]);this.l=t;this.p=i;var r=this.z.style;r["background-size"]=r["-webkit-background-size"]=r["-ms-background-size"]=r["-moz-background-size"]="cover";this.z.style.backgroundPosition="center"};_tb.c.prototype={f:null,a:null,l:null,p:null,r:!1,w:function(n){if(this.f!==n){this.f=n;this.bw("ImgUrl");this.l.h(this.a);this.a=null;this.k();if(this.f){var t=this;this.l.j(this.f,function(n,i){if(t.f===n){t.a=i;t.q();t.v();t.bf()}})}}return n},be:function(n){this.r=n;this.v();return n},o:!1,k:function(){if(!this.f||!this.a){this.z.style.backgroundImage="";this.z.style.color=""}},q:function(){if(this.a){this.z.style.backgroundImage="url('"+this.a+"')";this.z.style.color="transparent";this.z.textContent=""}else this.k()},bf:function(){this.a&&this.o&&(this.z.style.backgroundColor="white")},v:function(){if(this.r&&this.a){var n=this;_j.m.a().c(_a.a.h,"CalculateDominantColor",function(){var f=_j.n.b(n.J(),2,"ServerImageControl.CalculateDominantColor");var r=null;var t=null;try{if(n.z){var i=document.createElement("img");i.setAttribute("src",n.a);n.z.appendChild(i);t=n.z.lastChild;if(_j.k.j(t)>0){var u=new ColorThief;r=u.getColor(t)}}}finally{t&&_j.k.e(t);n.p.a(_a.dj,new _a.dj(r))}_j.n.a(f)})}}};_tb.b=function(n,t,i,r){this.s=Function.createDelegate(this,this.t);_tb.b.initializeBase(this,[n,t,r]);this.n=i};_tb.b.prototype={b:null,h:null,c:null,e:null,d:null,g:!1,n:null,u:function(n){if(this.b!==n){this.b=n;this.B();this.y();_j.h.b(this.c)||this.a?this.m():this.bd();this.bw("DisplayName")}return n},i:function(n){if(this.e!==n){_j.h.b(this.e)||this.bt(this.e);this.e=n;_j.h.b(this.b)&&this.m();this.bw("DoughBoyCssClassName")}return n},j:function(n){if(this.d!==n){_j.h.b(this.d)||this.bt(this.d);this.d=n;_j.h.b(this.b)&&this.m();this.bw("FadeInTransitionCssClassName")}return n},q:function(){_tb.c.prototype.q.call(this);this.t()},k:function(){_tb.c.prototype.k.call(this);if(!this.g){this.g=!0;this.n.a(this.J(),"AnimatedShowPersonImage",this.s,1500);this.z.style.opacity="0";_j.h.b(this.d)||this.bt(this.d)}},t:function(){if(this.g){this.g=!1;this.z.style.opacity="";_j.h.b(this.d)||this.bm(this.d)}},bd:function(){this.bt(this.e);this.z.style.backgroundColor=this.h;this.z.textContent=this.c},m:function(){this.z.style.backgroundColor="";this.z.textContent="";_j.h.b(this.e)||this.bm(this.e)},B:function(){this.c="";if(this.b){var n=this.x(this.b);_tb.b.b.test(n)?this.E(n):this.H(n)}},x:function(n){n=n.replace(_tb.b.d,"");n=n.replace(_tb.b.c," ");return n.trim()},H:function(n){var t=n.split(" ");if(t.length===2){this.c+=t[0].charAt(0).toUpperCase();this.c+=t[1].charAt(0).toUpperCase()}else if(t.length===3){this.c+=t[0].charAt(0).toUpperCase();this.c+=t[2].charAt(0).toUpperCase()}else t.length&&(this.c+=t[0].charAt(0).toUpperCase())},E:function(n){var t=n.replace(" ","");this.c=t.length<=2?t.charAt(t.length-1).toString():t.substring(t.length-2,t.length)},y:function(){this.h="";var r=0;if(this.b)for(var n=this.b.length-1;n>=0;n--){var i=this.b.charCodeAt(n);var t=n%8;r^=(i<<t)+(i>>8-t)}this.h=_tb.b.a[r%_tb.b.a.length]}};_tb.a=function(){this.c={};this.f={};this.b={};this.a=new Array(0);this.e=[]};_tb.a.prototype={d:0,h:function(n){if(_tb.a.a&&!Array.contains(this.a,n)){Array.add(this.a,n);var r=window.URL||window.webkitURL;if(this.a.length>_tb.a.b){var t=this.a[0];Array.removeAt(this.a,0);r.revokeObjectURL(t);var i=this.f[t];delete this.c[i];delete this.f[t]}}},j:function(n,t){if(n in this.c){var i=this.c[n];_tb.a.a&&Array.remove(this.a,i);t(n,this.c[n])}else this.i(n,t)},i:function(n,t){var i;if(n in this.b)i=this.b[n];else{i=[];Array.enqueue(this.e,n);this.b[n]=i}i[i.length]=t;this.g()},g:function(){if(!(this.d>=3)&&this.e.length){var t=Array.dequeue(this.e);this.d++;try{var n=new XMLHttpRequest;n.open("GET",t,!0);_tb.a.a&&(n.responseType="blob");var i=this;n.onreadystatechange=function(){if(n.readyState===4){i.d--;var u=0;var f=null;try{if(n.status===200){var c=n.getResponseHeader("Content-Type");var l=n.getResponseHeader("Content-Length");var a=!!c&&c.toLowerCase().startsWith("image");a?l&&(u=parseInt(n.getResponseHeader("Content-Length"))):u=0;if(_tb.a.a){f=n.response;f&&(u=f.size)}}else{var e=null;try{var h=new _a.P(t);e=_j.h.c("Textboys ServerImageDownloadService request failed. status = {0} , url authority = {1}, absolute path = {2}",n.status,h.d,h.e)}catch(p){e=_j.h.c("Textboys ServerImageDownloadService Invalid url. status = {0} , url = {1}",n.status,t)}_j.e.b(_a.a.bV,e)}}catch(y){}var r=null;if(u>100)if(_tb.a.a){var v=window.URL||window.webkitURL;r=v.createObjectURL(f)}else r=t;i.c[t]=r;var s=i.b[t];delete i.b[t];_tb.a.a&&r&&(i.f[r]=t);for(var o=0;o<s.length;o++)s[o](t,r);i.g()}};n.send(null)}catch(r){}}}};TextBoysComponents.registerClass("TextBoysComponents",null,_a.iJ,_j.cd);_tb.c.registerClass("_tb.c",_j.i);_tb.b.registerClass("_tb.b",_tb.c);_tb.a.registerClass("_tb.a");TextBoysComponents.$$cctor();_tb.b.d=new RegExp("\\([^)]*\\)|[\\0-\\u001F\\!-/:-@\\[-`\\{-\\u00BF\\u0250-\\u036F\\uD800-\\uFFFF]","g");_tb.b.c=new RegExp("\\s+","g");_tb.b.b=new RegExp("[\\u1100-\\u11FF|\\u3130-\\u318F|\\uA960-\\uA97F|\\uAC00-\\uD7AF|\\uD7B0-\\uD7FF]|[\\u4E00-\\u9FCC\\u3400-\\u4DB5\\uFA0E\\uFA0F\\uFA11\\uFA13\\uFA14\\uFA1F\\uFA21\\uFA23\\uFA24\\uFA27-\\uFA29]|[\\ud840-\\ud868][\\udc00-\\udfff]|\\ud869[\\udc00-\\uded6\\udf00-\\udfff]|[\\ud86a-\\ud86c][\\udc00-\\udfff]|\\ud86d[\\udc00-\\udf34\\udf40-\\udfff]|\\ud86e[\\udc00-\\udc1d]");_tb.b.a=["rgb(153, 180, 51)","rgb(107, 165, 231)","rgb(231, 115, 189)","rgb(0, 163, 0)","rgb(30, 113, 69)","rgb(255, 0, 151)","rgb(126, 56, 120)","rgb(96, 60, 186)","rgb(29, 29, 29)","rgb(0, 171, 169)","rgb(45, 137, 239)","rgb(43, 87, 151)","rgb(218, 83, 44)","rgb(185, 29, 71)","rgb(238, 17, 17)"];_tb.a.a=!_a.o.a().H||_a.o.a().S;_tb.a.b=100;
window.scriptsLoaded['microsoft.owa.application.textboys.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.application.textboys.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
